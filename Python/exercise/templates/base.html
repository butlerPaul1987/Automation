<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iron Forge Gym</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#0a0a0a;color:#fff;min-height:100vh}
        .container{max-width:1200px;margin:0 auto;padding:20px}
        .header{background:#000;border-bottom:2px solid #d1312c;padding:20px 0;margin-bottom:30px}
        .header-content{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;align-items:center;justify-content:space-between}
        .logo-container{display:flex;align-items:center;gap:15px}
        .logo{height:50px;width:auto}
        .logo-text{font-size:1.5em;font-weight:700;color:#d1312c;text-transform:uppercase}
        .user-info{display:flex;align-items:center;gap:15px;color:#999}
        .mobile-menu{display:none;position:relative}
        .hamburger{display:none;flex-direction:column;cursor:pointer;padding:5px}
        .hamburger span{width:25px;height:3px;background:#d1312c;margin:3px 0;transition:0.3s}
        .mobile-dropdown{display:none;position:absolute;top:100%;right:0;background:#111;border:1px solid #333;border-radius:4px;min-width:200px;z-index:1000}
        .mobile-dropdown a{display:block;padding:12px 16px;color:#999;text-decoration:none;border-bottom:1px solid #333}
        .mobile-dropdown a:hover{background:#1a1a1a;color:#d1312c}
        .mobile-dropdown a:last-child{border-bottom:none}
        .notification-badge{position:relative;cursor:pointer}
        .notification-count{position:absolute;top:-8px;right:-8px;background:#dc3545;color:white;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:.7em;font-weight:bold}
        .admin-badge{background:#d1312c;color:#000;padding:4px 12px;border-radius:4px;font-size:.75em;font-weight:700;text-transform:uppercase}
        .nav-tabs{display:flex;gap:10px;margin-bottom:30px;border-bottom:1px solid #333;overflow-x:auto}
        .nav-tab{padding:12px 24px;background:none;border:none;color:#999;cursor:pointer;font-size:.95em;font-weight:600;text-decoration:none;white-space:nowrap;border-bottom:2px solid transparent;transition:all .3s}
        .nav-tab:hover{color:#d1312c}
        .nav-tab.active{color:#d1312c;border-bottom-color:#d1312c}
        .btn{background:#d1312c;color:#000;border:none;padding:12px 24px;border-radius:4px;cursor:pointer;font-size:.95em;font-weight:600;text-decoration:none;display:inline-block;transition:all .3s}
        .btn:hover{background:#c9a532}
        .btn-secondary{background:#1a1a1a;color:#d1312c;border:1px solid #333}
        .btn-success{background:#28a745;color:white}
        .btn-danger{background:#dc3545;color:white}
        .btn-small{padding:8px 16px;font-size:.85em}
        .btn-block{width:100%;text-align:center}
        .form-group{margin-bottom:20px}
        label{display:block;margin-bottom:8px;color:#d1312c;font-weight:600;font-size:.9em;text-transform:uppercase}
        input,textarea,select{width:100%;padding:12px;background:#1a1a1a;border:1px solid #333;border-radius:4px;color:#fff;font-size:.95em}
        input:focus,textarea:focus,select:focus{outline:none;border-color:#d1312c}
        .card{background:#111;border:1px solid #222;border-radius:8px;padding:24px;margin-bottom:20px}
        .card-header{font-size:1.3em;font-weight:700;color:#d1312c;margin-bottom:20px;text-transform:uppercase}
        .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:30px}
        .stat-card{background:#1a1a1a;border:1px solid #333;border-radius:6px;padding:20px;text-align:center}
        .stat-label{color:#999;font-size:.85em;text-transform:uppercase;margin-bottom:8px}
        .stat-value{color:#d1312c;font-size:2em;font-weight:700}
        .workout-item,.program-item{background:#1a1a1a;border-left:3px solid #d1312c;padding:20px;margin-bottom:15px;border-radius:4px}
        .workout-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;flex-wrap:wrap;gap:10px}
        .workout-name{font-size:1.1em;font-weight:600;color:#fff}
        .workout-date{color:#999;font-size:.85em}
        .workout-stats{display:flex;gap:20px;margin:12px 0;flex-wrap:wrap}
        .workout-stat{display:flex;flex-direction:column}
        .workout-stat-label{color:#999;font-size:.75em;text-transform:uppercase}
        .workout-stat-value{color:#d1312c;font-size:1.2em;font-weight:700}
        .workout-notes{color:#aaa;margin-top:12px;font-size:.9em}
        .category-badge{background:#1a1a1a;border:1px solid #333;padding:4px 12px;border-radius:4px;font-size:.8em;color:#d1312c;text-transform:uppercase}
        .pr-badge{background:#28a745;color:white;padding:4px 12px;border-radius:4px;font-size:.8em;font-weight:700}
        .flash{padding:15px;border-radius:4px;margin-bottom:20px;font-weight:500}
        .flash-success{background:#1a3a1a;border:1px solid #2d5a2d;color:#4caf50}
        .flash-error{background:#3a1a1a;border:1px solid #5a2d2d;color:#f44336}
        .empty-state{text-align:center;padding:60px 20px;color:#666}
        .exercise-list{list-style:none}
        .exercise-list-item{background:#0a0a0a;padding:15px;margin-bottom:10px;border-radius:4px;border-left:2px solid #d1312c}
        .video-link{color:#d1312c;text-decoration:none;font-size:.9em}
        table{width:100%;border-collapse:collapse}
        th{background:#1a1a1a;color:#d1312c;padding:12px;text-align:left;font-size:.85em;text-transform:uppercase;border-bottom:2px solid #333}
        td{padding:12px;border-bottom:1px solid #222}
        tr:hover{background:#1a1a1a}
        @media (max-width:768px){.header{padding:20px 0}.header-content{flex-direction:row;gap:15px;justify-content:space-between;position:relative;align-items:left}.logo-container{flex:1;display:flex;justify-content:center}.logo{height:60px;width:auto}.logo-text{display:none}.user-info{display:none}.mobile-menu{display:block}.hamburger{display:flex}.stats-grid{grid-template-columns:1fr}.workout-header{flex-direction:column;align-items:flex-start}}
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo-container">
                <img src="https://www.ironforgegym.co.uk/wp-content/uploads/2022/08/IRON-VECTOR_inver002-1.svg" alt="Iron Forge" class="logo">
                <span class="logo-text">Training Tracker</span>
            </div>
            {% if session.get('username') %}
            <div class="user-info">
                <span>{{ session.get('username') }}</span>
                {% if session.get('is_admin') %}
                <span class="admin-badge">Coach</span>
                {% endif %}
                <a href="{{ url_for('notifications') }}" class="notification-badge">ðŸ””
                    {% if unread_notifications_count > 0 %}
                    <span class="notification-count">{{ unread_notifications_count }}</span>
                    {% endif %}
                </a>
                <a href="{{ url_for('messages') }}" class="btn btn-small btn-secondary">Messages</a>
                <a href="{{ url_for('logout') }}" class="btn btn-small btn-secondary">Logout</a>
            </div>
            <div class="mobile-menu">
                <div class="hamburger" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <div class="mobile-dropdown" id="mobile-dropdown">
                    <a href="{{ url_for('notifications') }}">ðŸ”” Notifications {% if unread_notifications_count > 0 %}({{ unread_notifications_count }}){% endif %}</a>
                    <a href="{{ url_for('messages') }}">ðŸ’¬ Messages</a>
                    <a href="{{ url_for('logout') }}">ðŸšª Logout</a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        {% for category, message in messages %}
        <div class="flash flash-{{ category }}">{{ message }}</div>
        {% endfor %}
        {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>
    
    {% if session.get('access_token') %}
    {% include 'session_info.html' %}
    {% endif %}
    
    <script>
    function toggleMobileMenu() {
        const dropdown = document.getElementById('mobile-dropdown');
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }
    
    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
        const menu = document.querySelector('.mobile-menu');
        const dropdown = document.getElementById('mobile-dropdown');
        if (menu && !menu.contains(event.target)) {
            dropdown.style.display = 'none';
        }
    });
    </script>
</body>
</html>